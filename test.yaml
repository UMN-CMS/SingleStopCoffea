analyzer:
  Signal312:
    # - module_name: SimpleHLT
    #   triggers: [HT, AK8SingleJetPt]
    # - module_name: VetoMapFilter
    #   input_col: Jet
    #   output_col: Jet

    # - module_name: SelectOnColumns
    #   sel_name: preselection

    - module_name: JetFilter
      input_col: Jet
      output_col: Jet

    - module_name: NObjFilter
      selection_name: njets
      input_col: Jet
      min_count: 4
      max_count: 6

    - module_name: SelectOnColumns
      sel_name: selection
      selection_names: [njets]

    - module_name: BQuarkMaker
      input_col: Jet
      output_col: MedBJet
      working_point: M

    - module_name: BQuarkMaker
      input_col: Jet
      output_col: TightBJet
      working_point: T

    - module_name: NNMassReco
      input_col: Jet
      m3_output: m3_comp
      m4_output: m4_comp
      model_path: nn_models/nominalBinaryCompressed0p67_24-09-18-20-06/jetMatcherNNTraced.pt
      scaler_path: nn_models/nominalBinaryCompressed0p67_24-09-18-20-06/scaler.pkl

    - module_name: NNMassReco
      input_col: Jet
      m3_output: m3_uncomp
      m4_output: m4_uncomp
      model_path: nn_models/nominalBinaryUncompressed0p67_24-09-18-19-53/jetMatcherNNTraced.pt
      scaler_path: nn_models/nominalBinaryUncompressed0p67_24-09-18-19-53/scaler.pkl

    - module_name: TopJetHistograms
      input_col: Jet
      output_col: Jet
      max_idx: 3
      prefix: "GoodJet_"

    - module_name: NNMassPlots
      m3_input: m3_comp
      m4_input: m4_comp
      prefix: "nncomp"

    - module_name: NNMassPlots
      m3_input: m3_uncomp
      m4_input: m4_uncomp
      prefix: "nnuncomp"
      

event_collections:
  - dataset: 'qcd*2018'
    pipelines: [Signal312]
  - dataset: 'signal_*_official'
    pipelines: [Signal312]
  # - dataset: 'signal_*official'
  #   pipelines: [Signal312]
  # - dataset: testqcd
  #   pipelines: [Signal312]
    
  
extra_executors:
  test:
    executor_name: ImmediateExecutor
    chunk_size: 1000000

  test2:
    executor_name: LocalDaskExecutor
    chunk_size: 400000
    min_workers: 1
    max_workers: 1
  
  testcondor:
    executor_name: LPCCondorDask
    container: /cvmfs/unpacked.cern.ch/registry.hub.docker.com/coffeateam/coffea-dask-almalinux9:2025.10.2-py3.12
    venv_path: .venv

    chunk_size: 200000
    max_workers: 200
