analyzer:
  Signal312:
    - module_name: SimpleHLT
      triggers: [HT,AK8SingleJetPt]
    - module_name: GoldenLumi
    - module_name: VetoMap
      input_col: Jet
    - module_name: VetoMapFilter
      input_col: Jet
      output_col: Jet
    - module_name: NoiseFilter

    - module_name: SelectOnColumns
      sel_name: pre_selection

    - module_name: PileupSF
    - module_name: L1PrefiringSF
    - module_name: JetScaleCorrections
      input_col: Jet
      output_col: Jet


    - module_name: ElectronMaker
      input_col: Electron
      output_col: GoodElectron
      working_point: "loose"
      min_pt: 10
      max_abs_eta: 2.4
      max_mini_iso: 0.1

    - module_name: MuonMaker
      input_col: Muon
      output_col: GoodMuon
      id_working_point: "looseId"
      min_pt: 30
      max_abs_eta: 2.4
      max_mini_iso: 0.1

    - module_name: JetFilter
      input_col: FatJet
      output_col: GoodFatJet
      min_pt: 200
      max_abs_eta: 2.4

    - module_name: JetFilter
      input_col: Jet
      output_col: GoodJet
      include_pu_id: True
      include_jet_id: True
      min_pt: 30
      max_abs_eta: 2.4

    - module_name: BQuarkMaker
      input_col: GoodJet
      output_col: MedB
      working_point: M
      
    - module_name: NObjFilter
      input_col: MedB
      selection_name: 2bjet
      min_count: 2


    - module_name: NObjFilter
      input_col: GoodElectron
      selection_name: zero_electron
      min_count: 0
      max_count: 0

    - module_name: NObjFilter
      input_col: GoodMuon
      selection_name: zero_muon
      min_count: 0
      max_count: 0

    - module_name: NObjFilter
      input_col: GoodJet
      selection_name: njets
      min_count: 4
      max_count: 6

    - module_name: VecDRSelection
      input_col: MedB
      selection_name: b_dr
      min_dr: 1.0

    - module_name: SelectOnColumns
      sel_name: selection

    - module_name: NNMassReco
      input_col: GoodJet
      m3_output: mChi_uncomp
      m4_output: mStop_uncomp
      model_path: "nn_models/nominalBinaryUncompressed0p67_24-09-18-19-53/jetMatcherNNTraced.pt"
      scaler_path: "nn_models/nominalBinaryUncompressed0p67_24-09-18-19-53/scaler.pkl"

    - module_name: NNMassReco
      input_col: GoodJet
      m3_output: mChi_comp
      m4_output: mStop_comp
      model_path: "nn_models/nominalBinaryCompressed0p67_24-09-18-20-06/jetMatcherNNTraced.pt"
      scaler_path: "nn_models/nominalBinaryCompressed0p67_24-09-18-20-06/scaler.pkl"

    - module_name: NNMassPlots
      m3_input: mChi_comp
      m4_input: mStop_comp
      prefix: comp

    - module_name: NNMassPlots
      m3_input: mChi_uncomp
      m4_input: mStop_uncomp
      prefix: uncomp

    - module_name: HT
      input_col: GoodJet

    - module_name: TopJetHistograms
      prefix: "jet"
      input_col: GoodJet
      max_idx: 4


        

location_priorities: [".*FNAL.*", ".*US.*", ".*(DE|IT|CH|FR).*", ".*(T0|T1|T2).*","eos"]

event_collections:
  - dataset: 'signal_2018_312_1500_1400'
    pipelines: [Signal312]
  
extra_executors:
  test:
    executor_name: ImmediateExecutor
    chunk_size: 1000000

  test2:
    executor_name: LocalDaskExecutor
    chunk_size: 400000
    min_workers: 1
    max_workers: 3
    reduction_factor: 2
  
  testcondor:
    executor_name: LPCCondorDask
    container: /cvmfs/unpacked.cern.ch/registry.hub.docker.com/coffeateam/coffea-dask-almalinux9:2025.10.2-py3.12
    venv_path: .venv
    chunk_size: 400000
    max_workers: 200
    worker_memory: 6GB
