common_objects: &common_objects
  - module_name: HElectronMaker
    input_col: Electron
    output_col: tightElectron
    working_point: "tight"
    min_pt: 15
    max_abs_eta: 2.5

  - module_name: HMuonMaker
    input_col: Muon
    output_col: tightMuon
    id_working_point: "tightId"
    min_pt: 15
    max_abs_eta: 2.4
    iso_working_pt: "tight"
    
  - module_name: HJetFilter
    input_col: Jet
    output_col: goodJet
    include_pu_id: False
    include_jet_id: True
    min_pt: 25
    max_abs_eta: 2.4

  - module_name: BQuarkMaker
    input_col: goodJet
    output_col: MedB
    working_point: M

  - module_name: HT
    input_col: goodJet

  - module_name: Count
    input_col: goodJet
    output_col: NJet 

  - module_name: Count
    input_col: MedB
    output_col: NbJet 

common_selection: &common_selection
  - module_name: NObjFilter
    input_col: tightElectron
    selection_name: zero_electron
    min_count: 0
    max_count: 0

  - module_name: NObjFilter
    input_col: tightMuon
    selection_name: zero_muon
    min_count: 0
    max_count: 0

  - module_name: NObjFilter
    input_col: goodJet
    selection_name: njets
    min_count: 6

common_histograms: &common_histograms
  - module_name: TopVecHistograms
    prefix: "jet"
    input_col: goodJet
    max_idx: 6

  - module_name: SimpleHistogram
    hist_name: HT
    input_cols: [HT]
    axes:
      - name: HT
        start: 0
        stop: 3000
        bins: 60
        unit: GeV
    
  - module_name: SimpleHistogram
    hist_name: NJet
    input_cols: [NJet]
    axes:
      - name: r"N_{jets}"
        start: 0
        stop: 14
        bins: 15
    
  - module_name: SimpleHistogram
    hist_name: NbJet
    input_cols: [NbJet]
    axes:
      - name: r"N_{b-jets}"
        start: 0
        stop: 14
        bins: 15




analyzer:
  default_run_builder:
    strategy_name: NoSystematics
  SignalRegion:
    - *common_objects
    - *common_selection
    - module_name: SelectOnColumns
      sel_name: selection
    - *common_histograms
    - module_name: JetComboHistograms
      input_col: MedB
      prefix: "b_dijet"
      jet_combos:
        - [0,1]
  NoSelection:
    - *common_objects
    - *common_histograms

location_priorities: [".*(T0|T1|T2).*","eos"]

event_collections:
  - dataset: 'ggHHbbVV_2018*'
    pipelines: [SignalRegion, NoSelection]
  - dataset: 'qcd*2018*'
    pipelines: [SignalRegion]
  - dataset: 'tt_to_hadronic*2018*'
    pipelines: [SignalRegion]
  - dataset: 'tt_to_semilep*2018'
    pipelines: [SignalRegion]
        
