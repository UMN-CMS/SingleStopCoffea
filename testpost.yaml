
processors:
  # - name: Histogram1D
  #   inputs:
  #     - "*/*/*/composite_13_m"
  #       
  #   structure:
  #     group: {era: "*", pipeline: "Signal*"}
  #     transforms:
  #       - name: MergeAxes
  #         merge_axis_names: [HT_Cat]
  #       - name: SplitAxes
  #         split_axis_names: {"variation": "central"}
  #   output_name: "testplots/{era.name}_{pipeline}_{name}.png"

  # - name: RatioPlot
  #   inputs:
  #     - "*/*/*/composite_13_m"
  #     - "*/*/*/composite_14_m"
  #     - "*/*/*/composite_24_m"
  #     - "*/*/*/HT"
  #   structure:
  #     select: {dataset_name: "!Signal*", pipeline: Control}
  #     group: {era: "*"}
  #     subgroups:
  #       denominator:
  #         select: {sample_type: MC}
  #       numerator:
  #         select: {sample_type: Data}
  #     transforms:
  #       - name: MergeAxes
  #         merge_axis_names: [HT_Cat]
  #       - name: SplitAxes
  #         split_axis_names: {"variation": "central"}
  #   output_name: "testplots/ratio_{era.name}_{name}.png"

  - name: RatioPlot
    inputs:
      - "*/*/*/composite_13_m"
      - "*/*/*/composite_14_m"
      - "*/*/*/composite_24_m"
      - "*/*/*/HT"
    scale: log
    structure:
      select: {type: Histogram, dataset_name: "!signal*"}
      group: {era.name: "*"}
      subgroups:
        numerator:
          select: {sample_type: Data, pipeline: Control }
        denominator:
          select: {sample_type: MC,  pipeline: ControlNoBNN}
      transforms:
        - name: MergeAxes
          merge_axis_names: [HT_Cat]
        - name: SelectAxesValues
          select_axes_values: {"variation": "central"}
    output_name: "{prefix}/ratio_nobnn_{era.name}_{name}.png"
    
  - name: RatioPlot
    inputs:
      - "*/*/*/composite_13_m"
      - "*/*/*/composite_14_m"
      - "*/*/*/composite_24_m"
      - "*/*/*/HT"
    scale: log
    structure:
      select: {type: Histogram, dataset_name: "!signal*"}
      group: {era.name: "*"}
      subgroups:
        numerator:
          select: {sample_type: Data, pipeline: Control }
        denominator:
          select: {sample_type: MC,  pipeline: Control}
      transforms:
        - name: MergeAxes
          merge_axis_names: [HT_Cat]
        - name: SelectAxesValues
          select_axes_values: {"variation": "central"}
    output_name: "{prefix}/ratio_{era.name}_{name}.png"

  - name: PlotSelectionFlow
    inputs:
      - "*/*/*/selection"
    structure:
      select: {type: SelectionFlow}
      group: {era.name: "*", pipeline: "*"}
    output_name: "{prefix}/cutflow_{era.name}_{pipeline}.png"


default_plot_config:
  cms_text: "Preliminary"
  image_type: ".png"
  cms_text_color: Black


default_style_set:
  styles:
    - pattern:
        dataset_name: 'data*'
      style:
        plottype: errorbar
        color: black
        linestyle: null
        marker: 'o'

    - pattern:
        dataset_name: 'qcd*'
      style:
        plottype: fill
        alpha: 0.3

    - pattern:
        dataset_name: 'tt*'
      style:
        plottype: fill
        alpha: 0.3

    - pattern:
        dataset_name: 'single*'
      style:
        plottype: fill
        alpha: 0.3

    - pattern:
        dataset_name: 'w*'
      style:
        plottype: fill
        alpha: 0.3


    - pattern:
        dataset_name: 'z*'
      style:
        plottype: fill
        alpha: 0.3
